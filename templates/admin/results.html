{% extends "base.html" %}

{% block title %}Declare Results{% endblock %}

{% block header %}Declare Winning Results{% endblock %}

{% block content %}
<div class="bg-white p-6 rounded-xl shadow-lg">
    <p class="text-gray-600 mb-4">Select a question, choose the winning option, and click "Process Results". This will
        automatically close the question, calculate winnings, and update user points. This action cannot be undone.</p>

    {% if not questions %}
    <div class="bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 rounded-lg" role="alert">
        <p class="font-bold">All Clear!</p>
        <p>There are no unresolved questions at the moment. (A question appears here after you close it for betting from
            the 'Manage Questions' page).</p>
    </div>
    {% endif %}

    <div class="space-y-6">
        {% for question in questions %}
        <form method="POST" action="{{ url_for('process_results', question_id=question.id) }}">
            <div class="border p-4 rounded-lg">
                <p class="font-semibold text-lg text-gray-700 mb-3">{{ question.text }}</p>
                <div class="flex items-end space-x-4">
                    <div class="flex-grow">
                        <label for="winning_option_id_{{ question.id }}"
                            class="block text-sm font-medium text-gray-700">Winning Option</label>
                        <select name="winning_option_id" id="winning_option_id_{{ question.id }}" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                            <option value="" disabled selected>-- Select the winner --</option>
                            {% for option in question.options %}
                            <option value="{{ option.id }}">{{ option.text }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button type="submit"
                        class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg">Process
                        Results</button>
                </div>
            </div>
        </form>
        {% endfor %}
    </div>
</div>
{% endblock %}