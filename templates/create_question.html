{% extends "base.html" %}

{% block title %}Create Question - {{ event.name }}{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
        <div class="card shadow">
            <div class="card-header">
                <h5><i class="fas fa-plus"></i> Add Betting Question</h5>
                <small class="text-muted">{{ event.sport.name }} - {{ event.name }}</small>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="mb-3">
                        <label for="question" class="form-label">Question *</label>
                        <textarea class="form-control" id="question" name="question" rows="3" required
                            placeholder="e.g., Which team will win Cricket Semi-Final 1?"></textarea>
                    </div>

                    <div class="mb-3">
                        <label for="question_type" class="form-label">Question Type *</label>
                        <select class="form-select" id="question_type" name="question_type" required>
                            <option value="">Select question type</option>
                            <option value="team_winner">Team Winner</option>
                            <option value="total_runs">Total Runs</option>
                            <option value="total_sixes">Total Sixes</option>
                            <option value="final_teams">Final Teams</option>
                            <option value="score_prediction">Score Prediction</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="options" class="form-label">Options *</label>
                        <textarea class="form-control" id="options" name="options" rows="3" required
                            placeholder="Enter options separated by commas&#10;e.g., Alpha Wolves, Black Pirates, Dragon Slayers, Viking Warriors"></textarea>
                        <div class="form-text">Separate multiple options with commas</div>
                    </div>

                    <div class="mb-3">
                        <label for="odds" class="form-label">Odds *</label>
                        <textarea class="form-control" id="odds" name="odds" rows="3" required
                            placeholder="Enter odds for each option separated by commas&#10;e.g., 1.5, 2.0, 2.5, 3.0"></textarea>
                        <div class="form-text">Enter odds for each option in the same order, separated by commas</div>
                    </div>

                    <div class="alert alert-info">
                        <h6><i class="fas fa-info-circle"></i> Odds Guide:</h6>
                        <ul class="mb-0">
                            <li><strong>1.0x</strong> = Even odds (no profit)</li>
                            <li><strong>2.0x</strong> = Double your bet</li>
                            <li><strong>3.0x</strong> = Triple your bet</li>
                            <li>Higher odds = Less likely outcome</li>
                        </ul>
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{{ url_for('manage_questions', event_id=event.id) }}"
                            class="btn btn-outline-secondary">
                            Cancel
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Create Question
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div class="card mt-3">
            <div class="card-header">
                <h6><i class="fas fa-lightbulb"></i> Question Examples</h6>
            </div>
            <div class="card-body">
                <div class="example-questions">
                    <div class="example mb-3">
                        <strong>Team Winner:</strong><br>
                        <small class="text-muted">
                            Question: "Which team will win Cricket Semi-Final 1?"<br>
                            Options: "Alpha Wolves, Black Pirates, Dragon Slayers, Viking Warriors"<br>
                            Odds: "1.5, 2.0, 2.5, 3.0"
                        </small>
                    </div>
                    <div class="example mb-3">
                        <strong>Total Runs:</strong><br>
                        <small class="text-muted">
                            Question: "How many total runs will the winning team score?"<br>
                            Options: "0-50, 51-100, 101-150, 150+"<br>
                            Odds: "2.5, 2.0, 1.8, 3.0"
                        </small>
                    </div>
                    <div class="example">
                        <strong>Total Sixes:</strong><br>
                        <small class="text-muted">
                            Question: "How many sixes will be hit in the final match?"<br>
                            Options: "0-2, 3-5, 6-8, 9+"<br>
                            Odds: "1.5, 2.0, 2.5, 4.0"
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const optionsInput = document.getElementById('options');
        const oddsInput = document.getElementById('odds');

        function updateOddsPlaceholder() {
            const options = optionsInput.value.split(',').map(opt => opt.trim()).filter(opt => opt);
            if (options.length > 0) {
                const placeholder = options.map(() => '1.0').join(', ');
                oddsInput.placeholder = `Enter odds separated by commas: ${placeholder}`;
            }
        }

        optionsInput.addEventListener('input', updateOddsPlaceholder);

        // Validate odds match options
        function validateOdds() {
            const options = optionsInput.value.split(',').map(opt => opt.trim()).filter(opt => opt);
            const odds = oddsInput.value.split(',').map(odd => odd.trim()).filter(odd => odd);

            if (options.length !== odds.length && odds.length > 0) {
                oddsInput.setCustomValidity('Number of odds must match number of options');
            } else {
                oddsInput.setCustomValidity('');
            }
        }

        optionsInput.addEventListener('input', validateOdds);
        oddsInput.addEventListener('input', validateOdds);
    });
</script>
{% endblock %}